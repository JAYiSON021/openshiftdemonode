{"version":3,"sources":["../src/index.js"],"names":["localStrategy","require","Strategy","app","server","createServer","use","json","limit","bodyLimit","initialize","Account","usernameField","passwordField","authenticate","serializeUser","deserializeUser","static","logErrors","clientErrorHandler","listen","port","console","log","address"],"mappings":";;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AAGA;;;;AACA;;;;AAEA;;;;AACA;;;;AAEA;;;;;;AAXA,IAAMA,gBAAgBC,QAAQ,gBAAR,EAA0BC,QAAhD,C,CANA;;;AAUA;;;AASA,IAAIC,MAAM,wBAAV;AACAA,IAAIC,MAAJ,GAAa,eAAKC,YAAL,CAAkBF,GAAlB,CAAb;;AAEA;AACA;AACAA,IAAIG,GAAJ,CAAQ,qBAAWC,IAAX,CAAgB;AACpBC,WAAO,iBAAOC;AADM,CAAhB,CAAR;;AAIAN,IAAIG,GAAJ,CAAQ,iCAAR;AACAH,IAAIG,GAAJ,CAAQ,qBAAR;;AAEA;AACAH,IAAIG,GAAJ,CAAQ,mBAASI,UAAT,EAAR;AACA,IAAIC,UAAUV,QAAQ,wBAAR,CAAd;AACA,mBAASK,GAAT,CAAa,IAAIN,aAAJ,CAAkB;AAC3BY,mBAAe,OADY;AAE3BC,mBAAe;AAFY,CAAlB,EAITF,QAAQG,YAAR,EAJS,CAAb;AAMA,mBAASC,aAAT,CAAuBJ,QAAQI,aAAR,EAAvB;AACA,mBAASC,eAAT,CAAyBL,QAAQK,eAAR,EAAzB;;AAEAb,IAAIG,GAAJ,CAAQ,kBAAQW,MAAR,CAAe,QAAf,CAAR;;AAEA;AACAd,IAAIG,GAAJ,CAAQ,QAAR;;AAEA;AACAH,IAAIG,GAAJ,CAAQ,KAAR;;AAEAH,IAAIG,GAAJ,CAAQ,wBAAaY,SAArB;AACAf,IAAIG,GAAJ,CAAQ,wBAAaa,kBAArB;;AAEAhB,IAAIC,MAAJ,CAAWgB,MAAX,CAAkB,iBAAOC,IAAzB;AACAC,QAAQC,GAAR,6BAAsCpB,IAAIC,MAAJ,CAAWoB,OAAX,GAAqBH,IAA3D;;kBAEelB,G","file":"index.js","sourcesContent":["// Core\r\nimport http from 'http';\r\nimport express from 'express';\r\nimport bodyParser from 'body-parser';\r\nimport mongoose from 'mongoose';\r\nimport passport from 'passport';\r\nconst localStrategy = require('passport-local').Strategy;\r\nimport validator from 'express-validator';\r\nimport Promise from 'promise';\r\n\r\n// Utils\r\nimport config from './config';\r\nimport errHandlerGG from './middlewares/errors/error_handler';\r\n\r\nimport routes from './routes';\r\nimport cors from 'cors';\r\n\r\nimport adminRoutes from './admin/routes';\r\n\r\nlet app = express();\r\napp.server = http.createServer(app);\r\n\r\n// middlewares\r\n// -> parse application/json\r\napp.use(bodyParser.json({\r\n    limit: config.bodyLimit\r\n}));\r\n\r\napp.use(validator());\r\napp.use(cors());\r\n\r\n// passport config\r\napp.use(passport.initialize());\r\nlet Account = require('./models/users/account');\r\npassport.use(new localStrategy({    \r\n    usernameField: 'email',\r\n    passwordField: 'password'\r\n},\r\n    Account.authenticate()\r\n));\r\npassport.serializeUser(Account.serializeUser());\r\npassport.deserializeUser(Account.deserializeUser());\r\n\r\napp.use(express.static('public'));\r\n\r\n// API ROUTES ADMIN\r\napp.use('/admin', adminRoutes);\r\n\r\n// API ROUTES V1\r\napp.use('/v1', routes);\r\n\r\napp.use(errHandlerGG.logErrors);\r\napp.use(errHandlerGG.clientErrorHandler);\r\n\r\napp.server.listen(config.port);\r\nconsole.log(`Server running on port ${app.server.address().port}`);\r\n\r\nexport default app;"]}